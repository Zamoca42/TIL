# Python

# 파이썬으로 파일 read / write 하는 법

## 파일 쓰는 법

```py
파일 = open('a.txt', 'w')
파일.write('hello')
파일.close()
```

- a.txt라는 파일이 없으면 하나 만듭니다.
- 이미 있으면 내용을 덮어쓰기를 합니다.

## 파일 읽는 법

```py
파일 = open('a.txt', 'r')
print( 파일.read() )
파일.close()
```

## 파일에 내용 추가하는 법

```py
파일 = open('a.txt', 'a')
파일.write('hello')
파일.close()
```

이렇게 a라는 모드로 오픈하고 글쓰고 닫고 하시면 됩니다.

append라는 모드입니다. 내용을 덮어쓰기하는게 아니라 기존 내용에 hello라는 글자를 추가만 해줍니다.

# for 반복문

```py
for i in range(몇번반복할건지) :
  반복해줄코드
```

그러면 range()안에 넣은 숫자 갯수만큼 indent들어간 코드를 여러번 복사 (반복) 해줍니다.

이제 손수 복붙할 필요가 없어집니다.

그리고 i 라는 부분은 변수하나 아무렇게나 작명하시면됩니다. 전 i가 좋아서 i라고 했을 뿐입니다.

이 변수의 용도는 조금 나중에 소개해드립니다.

```py
for i in range(10) :
  print('BMW 있어요 사셈')
```

for 반복문을 적용했습니다. 그럼 열번정도 저 indent 들어간 코드를 복붙해줍니다.

i 라는 변수는 코드가 복붙될 때 마다 0,1,2 ... 이렇게 1씩 증가하는 숫자입니다.

진짜 확인하고 싶으면 i라는 변수를 print로 출력해보십시오.

## 반복문은 이럴 때도 씁니다

자료를 하나씩 출력하거나 하나씩 조작하고 싶을 때도 씁니다.

예를 들면 이런 데이터가 있다고 칩시다.

```py
중고차들 = ['K5', 'BMW', 'spark']
```

이 안에 있는 모든 데이터들을 하나씩 print 하고 싶으면 어떻게 코드를 짜야합니까.

대충 이런게 아닐까요.

```py
중고차들 = ['K5', 'BMW', 'Tico']
print(중고차들[0])
print(중고차들[1])
print(중고차들[2])
```

이러면 하나씩 다 출력해줄 수 있습니다. 끝입니다.

근데 이걸 똑같이 반복문으로 만들 수도 있습니다.

```py
중고차들 = ['K5', 'BMW', 'Tico']
for i in 중고차들:
print(i)
```

이러면 아까처럼 모든 데이터를 출력할 수 있습니다. 약간 코드가 더 줄었죠? 그래서 씁니다.

해설을하자면

1.  리스트자료형을 집어넣으면 리스트 갯수만큼 반복문이 실행됩니다. (3번반복되겠죠?)

2.  리스트 자료를 집어넣었을 땐 i라는 변수는 반복문이 실행될 때마다 리스트 안에있던 하나하나의 자료를 뜻합니다.

(그래서 i는 반복문이 실행될 때 차례로 K5, BMW, spark가 됩니다.)

이런 특징 때문에 range() 말고 리스트로 for 반복문을 돌리시면

그 리스트 안에 있던 자료를 쉽게 꺼내쓸 수 있게 됩니다. 자료꺼낼 때 쌩코딩안해도되고 편리해서 씁니다.

자료를 전부 조작하기도 쉬워집니다.

이번엔 그 K5, BMW 이런 글자 뒤에 "사세요~" 라는 단어를 붙여서 출력해주고 싶은겁니다.

코드를 어떻게 짜면 될까요 ㄷㄷ

```py
중고차들 = ['K5', 'BMW', 'spark']
for i in 중고차들:
print(i + '사세요!!!!!!!')
```

이러면 리스트 안에 있던 K5, BMW 이런 단어들 뒤에 "사세요!!!!!"를 붙여서 출력도 가능합니다.

이런 식으로 리스트 안에 있던 자료를 한꺼번에 조작하는 것도 쉬워지는 것입니다.

## 추가로 알아야할 것들

- 리스트 말고 딕셔너리 자료도 for 반복문에 입력가능합니다.

- range()를 쓰실 때 약간 더 명시적으로 쓸 수 있습니다. 숫자 두개도 입력 가능합니다.

range(0,10) 이렇게 쓰면 0부터 10이 되기 전까지 indent들어간 코드를 복붙해주세요~ (10번 복붙됨)

range(1,6) 이렇게 쓰면 1부터 6이 되기 전까지 indent 들어간 코드를 복붙해주세요~ (5번 복붙됨)

이런 뜻입니다.

- range를 저렇게 쓰실 경우 i의 값도 살짝 달라집니다.

range(0,10) 이렇게 쓰면 i는 복붙될 때 마다 1,2,3,4,5,6,7,8,9가 됩니다.

range(1,6) 이렇게 쓰면 i는 복붙될 때 마다 1,2,3,4,5가 됩니다.

(실은 range()함수는 리스트 만들어주는 함수라 그렇습니다. range(2,7) 이러면 `[2,3,4,5,6]` 이런 리스트가 그 자리에 남습니다. 이걸 알면 왜 i가 저렇게 변하는지도 이해가 되겠죠?)

# 함수문법 def

## 함수의 용도 1. 긴코드 짧게 축약할 때 씁니다

함수는 꼭 써야되는 문법도 아니고  

내 코드에 멋좀 내기 위해 쓰는 것도 아닙니다.   

자주쓰이는 긴코드가 있다면 그걸 짧은 한 단어로 축약하고 싶을 때 쓰시면 됩니다. 

```py
print('안녕하세요 중고차신뢰딜러 차은우입니다')
print('현재 딜러할인 최대 적용중이라 쪽지로 문의주십쇼')
```
이런 긴 코드가 매우 자주 필요하다고 생각해봅시다.

그럼 그 때마다 이거 긴 코드 복붙하고 그래야하겠죠?

귀찮다면 함수문법을 쓰시면 이 긴 코드를 짧게 한 단어로 축약이 가능합니다. 

```py
 def 인사하기():
    print('안녕하세요 중고차신뢰딜러 차은우입니다')
    print('현재 딜러할인 최대 적용중이라 쪽지로 문의주십쇼')

인사하기()
```
이렇게 하시면 되겠습니다. 

이제 원하는 곳에서 인사하기() 이것만 쓰시면 긴 두줄의 코드가 출력됩니다. 

앞으로 훨씬 코드가 간결해지겠군요.

## 함수의 용도 2. 마법의 모자 만들 때도 씁니다

여러분이 고등학교를 나왔다면 파이썬 함수는 수학의 함수와 똑같다라고 설명하면 바로 알아듣습니다.  

"수학에선 f(x) = 2 + x 인 경우 f(2) 그리고 f(4) 이런걸 할 수 있지않냐 파이썬도 똑같습니다 끗"

여기까지 설명하면 함수 설명 끝인데  

하지만 고등학교 기억이 없을 수 있으니 초등학교레벨로 설명해드리겠습니다.   

2를 집어넣으면 4가 나오고

4를 집어넣으면 6이 나오고 

이렇게 +2를 해주는 기계가 가끔 필요합니다. 

가끔은 * 2 해주는 기계도 가끔 필요하고요. 

그런 마법의 모자가 필요하면 함수를 만들어쓰시면 됩니다.

파이썬 함수도 그런 magic hat 역할을 해줄 수 있습니다.

마법의 모자는 어떻게 만드냐면

```py
def 함수이름(인풋) : 
    인풋으로 뭐할지 여기에 작성
```
이렇게 코드짜시면 됩니다. 그럼 마법모자 완성입니다.  

예를 들면 뭔가 숫자를 집어넣으면 2를 더해주는 모자를 만들고 싶습니다. 

그건 이렇게 만드시면 됩니다. 

```py
def 모자(숫자) :
    print(숫자 + 2)
```
끝입니다.

그럼 이제 함수를 사용하실 때 함수소괄호안에 뭔가를 집어넣을 수 있는데 

```py
def 모자(숫자) :
    print(숫자 + 2)

모자(4)
모자(6)
```
이렇게요.

이게 뭔뜻이냐면 모자()라는 함수를 쓰는데 숫자란에 4를 집어넣어서 실행해주세요~

모자()라는 함수를 쓰는데 숫자란에 6을 집어넣어서 실행해주세요~

라는 뜻입니다.

그럼 실행해보면 각각 6과 8이라는 결과가 뜰겁니다.

이게 아까말한 기계만드는 법입니다.

4를 집어넣으면 6 나오고 6 집어넣으면 8 나오죠?

그럼 집어넣은 숫자를 * 2 해주는 함수는 어떻게 만들까요?

알아서 해보시면 되겠습니다.

(참고1) 함수안에 숫자만 넣는게 아니라 모든 자료형 다 넣을 수 있습니다. 

(참고2) 집어넣는 숫자를 늘리고 싶으면 함수만들 때 def 함수(숫자1, 문자2) : 이렇게 콤마로 구분해서 여러가지 적으면 됩니다. 그리고 자유작명입니다. 그리고 집어넣는 숫자같은걸 전문개발용어로 파라미터라고 합니다.

(참고3) 함수는 위에서 만들어놔야 밑에서 함수() 이렇게 쓸 수 있습니다.

# 웹 크롤러

수집할 사이트 : https://finance.naver.com/item/sise.nhn?code=005930

평소에 웹에서 데이터수집 하는 업무를 자주 한다면 웹크롤러로 자동화 해놓으십시오.

데이터를 활용하는 IT 서비스를 창업하고 싶다면 웹크롤러를 사용하십시오.

데이터 분석 이전 분석할 데이터는 어디서 구할겁니까. 당연히 웹 크롤러를 사용합니다.

웹크롤러는 웹사이트에서 데이터를 가져와서 자동으로 정리/저장해주는 프로그램을 말합니다.

크롤러 만드는 법은 쉽습니다.

1. 파이썬으로 원하는 웹페이지 접속해서 그 페이지에 있는 HTML 그대로 전부 다운받음

2. 원하는 글자있는 부분만 딱 찝어냅니다.

3. 그걸 저장하든 뭐하든 합니다.

끝입니다.

반복문으로 1~3번 코드를 복붙하면 단시간에 백만개 페이지 수집하는 프로그램도 만들 수 있겠군요.

## CSS 셀렉터 참고용

CSS 셀렉터를 알고계시면 soup.select() 함수를 이용해서 원하는 데이터를 더욱 엄격하게 자세하게 찾을 수 있습니다.

```py
soup.select('.class명')
soup.select('#id명')
soup.select('태그명') (HTML 태그명은 아무것도 안붙임)
soup.select('.class명1 .class명2') (띄어쓰기는 '~내부의' 라는 뜻)
```

## 이미지 URL을 알고있을 때 파일로 저장하는 법

```py
import urllib.request #import 모여있는 맨위에다가 작성

urllib.request.urlretrieve(이미지URL, '파일명')
```

이 코드 한줄이면 됩니다. 끝!

이미지 URL 란에는 여러분이 찾아온 이미지 URL 진짜 담으시면 되고

'파일명' 부분에는 '어쩌구.jpg' 이런 식으로 파일명 맘대로 작성해주시면 됩니다.

실행하면 파이썬 파일이랑 나란한 곳에 어쩌구.jpg가 저장됩니다.

## 함수에 파라미터 구멍을 뚫을 때 잘보고 해야합니다. 

구멍뚫기 문법을 사용하면 함수를 업그레이드할 수 있습니다. 

이전 문법예제처럼 3을 집어넣으면 1+3을 연산해주고 4를 집어넣으면 1+4를 연산해주는 다양한 기능을 할 수 있는 함수를 만들려면

함수에 구멍만 뚫어주시면 됩니다. 

대충 뚫으시면 된다고 했는데 실은 아무데나 막 집어넣으시면 안됩니다. 

구멍이라는 글자는 일종의 변수 이기 때문에 변수처럼 생각해서 잘 넣으셔야합니다. 

- 다른 변수이름 중간에 집어넣을 수 없습니다. 

- '문자자료형' 중간에 구멍을 뚫고 싶으면 특수한 방법이 필요합니다. 

문자자료형 중간에 구멍을 뚫고 싶어서 이렇게 했는데 

```py
def 현재가(구멍):
  데이터 = requests.get('https://finance.naver.com/item/sise.nhn?code=구멍') 
```
이렇게 대충 문자자료 중간에 '구멍'이라고 집어넣으면 안된다는 소리입니다.  

저렇게 집어넣으면 "구멍에 들어온 값을 여기 집어넣어주세요~"라는 뜻이 아니라

구멍이라는 일반 문자로 변해버립니다

그래서 문자 중간에 변수를 넣을 땐 변수가 문자로 바뀌지 않도록 보존해서 집어넣으셔야 하는데 

formatting 문법을 이용하시면 안전하게 문자중간에 변수를 집어넣을 수  있습니다. 

파이썬에서 문자중간에 변수를 넣고 싶으면 

```py
f'문자 {변수} 문자'
```

1. 이렇게 문자중간에 {} 기호로 변수이름을 집어넣고

2. f를 맨앞에 추가합니다. 

이게 formatting 문법 끝입니다. (옛날 책 보시면 % 어쩌구 이런거 썼는데 요즘은 이렇게 합니다)

```py
def 현재가(구멍):
  데이터 = requests.get(f'https://finance.naver.com/item/sise.nhn?code={구멍}') 
```

결론은 문자중간에 구멍을 뚫고 싶으면 이렇게 하라는 소리입니다.

길었던 코드 함수로 축약하기 프로젝트 끝!

그럼 이제 함수사용할 때 구멍자리에 원하는 종목코드를 넣으면 그 종목의 현재가격 등을 알아서 출력해줍니다. 

예를 들면 현재가('005930') 이런 코드를 작성하면 삼성전자 현재가를 출력해주겠군요.

함수를 쓰고난 자리에 뭔가 퉤 뱉고 싶습니다 

```py
def 예시함수():
  return '어쩌구'
```

이렇게 쓰시면 예시함수()를 실행하고나서 그 자리에 '어쩌구'라는 데이터를 뾰로롱 남겨줍니다.

퉤~ 뱉는다고 기억해주셔도 됩니다. 

그럼 우리가 만들었던 크롤러 함수를 이렇게 업그레이드하면 어떻게 될까요.

```py
def 현재가(구멍):
  데이터 = requests.get(f'https://finance.naver.com/item/sise.nhn?code={구멍}')
  soup = BeautifulSoup(데이터.content, 'html.parser')
  return soup.find_all('strong', id="_nowVal")[0].text
```

현재가() 함수를 실행하고 나면 그 자리에 `soup.find_all('strong', id="_nowVal")[0].text` 이런걸 퉤 뱉어줍니다. 

그리고 그것은 현재 가격입니다.  

예를 들면 현재가('005930') 이런 코드를 작성하면 그 자리에 삼성전자 현재가격이 뾰로롱 남습니다. 

return 덕분입니다. 

그럼 이제 

```py
price = 현재가('005930')
f.write(price)
```

변수에 저장하든지 

파일에 작성하든지 

리스트에 append() 로 추가 해보던지 맘대로 다루기 쪼금 더 편리해집니다. 

그래서 return을 사용합니다.  

def, return, for 이런거 문법을 외우는게 중요한게 아니라 문법을 대체 언제 써야 하는지 아셔야 스스로 프로그래밍 잘하는 사람이 됩니다. 

언제쓰는지 모르면 "함수 여기서 쓰는거맞아요? 반복문 이거 꼭 써야해요?" 이런 질문을 평생하게 됩니다.  
